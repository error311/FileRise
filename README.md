# FileRise

[![GitHub stars](https://img.shields.io/github/stars/error311/FileRise?style=social)](https://github.com/error311/FileRise)
[![Docker pulls](https://img.shields.io/docker/pulls/error311/filerise-docker)](https://hub.docker.com/r/error311/filerise-docker)
[![Docker CI](https://img.shields.io/github/actions/workflow/status/error311/filerise-docker/main.yml?branch=main&label=Docker%20CI)](https://github.com/error311/filerise-docker/actions/workflows/main.yml)
[![CI](https://img.shields.io/github/actions/workflow/status/error311/FileRise/ci.yml?branch=master&label=CI)](https://github.com/error311/FileRise/actions/workflows/ci.yml)
[![Demo](https://img.shields.io/badge/demo-live-brightgreen)](https://demo.filerise.net)
[![Release](https://img.shields.io/github/v/release/error311/FileRise?include_prereleases&sort=semver)](https://github.com/error311/FileRise/releases)
[![License](https://img.shields.io/github/license/error311/FileRise)](LICENSE)
[![Discord](https://img.shields.io/badge/Discord-join_chat-5865F2?logo=discord&logoColor=white)](https://discord.gg/7WN6f56X2e)
[![Sponsor on GitHub](https://img.shields.io/badge/Sponsor-‚ù§-red)](https://github.com/sponsors/error311)
[![Support on Ko-fi](https://img.shields.io/badge/Ko--fi-Buy%20me%20a%20coffee-orange)](https://ko-fi.com/error311)

**FileRise** is a self-hosted web file manager with WebDAV, sharing, and per-folder ACLs.  
Drag & drop uploads, OnlyOffice integration, and **optional folder-level encryption at rest** ‚Äî all in one PHP app you control.

Built for homelabs, teams, and client portals that need fast browsing, strict ACLs, and zero-database simplicity.

## Table of contents

- [Quick links](#quick-links)
- [Install (Docker ‚Äì recommended)](#install-docker--recommended)
- [Manual install (PHP web server)](#manual-install-php-web-server)
- [Data & backups](#data--backups)
- [First-run security checklist](#first-run-security-checklist)
- [Optional dependencies](#optional-dependencies)
- [WebDAV & ONLYOFFICE (optional)](#webdav--onlyoffice-optional)
- [Security & updates](#security--updates)
- [Community, support & contributing](#community-support--contributing)
- [AI Disclosure](#ai-disclosure)
- [License & third-party code](#license--third-party-code)
- [Press](#press)

---

## Highlights

- üíæ **Self-hosted ‚Äúcloud drive‚Äù** ‚Äì Runs anywhere with PHP (or via Docker). No external database required.
- üîê **Granular per-folder ACLs** ‚Äì Manage View (all/own), Upload, Create, Edit, Rename, Move, Copy, Delete, Extract, Share, and more ‚Äî all enforced consistently across the UI, API, and WebDAV.
- üîê **Folder-level encryption at rest (optional)** ‚Äì Encrypt entire folders (and all descendants) on disk using modern authenticated encryption.
  - Opt-in per folder with inherited protection for subfolders
  - Files are stored encrypted on disk and transparently decrypted on download
  - Master key can be generated by FileRise or supplied via environment variable
  - When enabled, incompatible features (WebDAV, sharing, ZIP operations, OnlyOffice) are automatically disabled for safety
- üîÑ **Fast drag-and-drop uploads** ‚Äì Chunked, resumable uploads with pause/resume and progress tracking. If your connection drops, FileRise resumes automatically.
- ü™ü **Dual-pane mode + keyboard shortcuts** ‚Äì Optional two-pane file browser for fast workflows (copy/move between panes, compare folders, and operate without the mouse). Shortcut overlay + hotkeys (F3 preview, F4 edit, F5 copy, F6 move, F7 new folder, Del delete, `/` search).
- üå≥ **Scales to huge trees** ‚Äì Tested with **100k+ folders** in the sidebar tree without choking the UI.
- üåà **Visual organization** ‚Äì Color-code folders in the tree, inline list, and folder strip, plus tag files with color-coded labels for fast visual scanning.
- üëÄ **Hover preview ‚Äúpeek‚Äù cards** ‚Äì On desktop, hover files or folders to see thumbnails (images/video), quick metadata (size, timestamps, tags), and effective permissions. Per-user toggle stored in `localStorage`.
- üé¨ **Smart media handling** ‚Äì Track per-file video watch progress with a ‚Äúwatched‚Äù indicator, remember last volume/mute state, and reset progress when needed.
- üß© **OnlyOffice support (optional)** ‚Äì Edit DOCX/XLSX/PPTX using your own Document Server; ODT/ODS/ODP supported as well. PDFs can be viewed inline.
- üåç **WebDAV (ACL-aware)** ‚Äì Mount FileRise as a drive from macOS, Windows, Linux, or Cyberduck/WinSCP. Listings, uploads, overwrites, deletes, and folder creation all honor the same ACLs as the web UI.
- üè∑Ô∏è **Tags, search & trash** ‚Äì Tag files, search by name/tag/uploader/content via fuzzy search, and recover mistakes using a Trash with time-based retention.
- üìö **API + live docs** ‚Äì OpenAPI spec served at `api.php?spec=1` (from `openapi.json.dist`) with a Redoc UI at `api.php` (login required).
- üìä **Storage / disk usage summary** ‚Äì CLI scanner with snapshots, total usage, and per-volume breakdowns surfaced in the admin panel.
- üé® **Polished, responsive UI** ‚Äì Dark/light mode, mobile-friendly layout, in-browser previews, and a built-in code editor powered by CodeMirror.
- üåê **Internationalization** ‚Äì English, Spanish, French, German, Polish, Russian, Japanese and Simplified Chinese included; community translations welcome.
- üîë **Login + SSO** ‚Äì Local users, TOTP 2FA, and OIDC (Auth0 / Authentik / Keycloak / etc.) with optional auto-provisioning, IdP-driven admin role assignment, and Pro user-group mapping.
- üõ°Ô∏è **ClamAV virus scanning (Core) + Pro virus log** ‚Äì Optional ClamAV upload scanning, with a Pro virus detection log in the admin panel and CSV export.
- üåê **Reverse proxy & subpath aware** ‚Äì Designed to run cleanly behind Nginx, Traefik, Caddy, or Apache:
  - Supports installs under a subpath (e.g. `https://example.com/files`)
  - Correct URL generation for assets, APIs, portals, PWA, and share links
  - If the proxy strips the prefix, set `FR_BASE_PATH` or send `X-Forwarded-Prefix`
  - Explicit ‚ÄúPublished URL‚Äù setting for proxy / firewall environments
  - Works with `X-Forwarded-*` headers and Kubernetes ingress setups
- üë• **Pro: user groups, client portals, global search, storage explorer & audit logs** ‚Äì  
  Group-based ACLs, brandable client upload portals, **ACL-aware global search across files, folders, users, and permissions**, an ncdu-style storage explorer for identifying large folders/files and reclaiming disk space directly from the UI, and **Pro Audit Logs** (configurable activity logging with filters + CSV export for tracking key actions across web, WebDAV, shares, and portals).
- üåê **Pro: Sources (multi-storage adapters)** ‚Äì  
  Turn FileRise into a storage hub by connecting multiple backends and switching between them in the UI:
  - Multiple local roots (additional local paths)
  - **S3-compatible** (AWS S3 / MinIO / Wasabi / Backblaze B2 S3 / etc.)
  - **SMB/CIFS**, **SFTP**, **FTP**
  - **WebDAV** (Nextcloud / ownCloud / FileRise)
  - **Google Drive**
  - Works with **dual-pane** so you can copy/move via drag & drop or toolbar actions **between sources**, with **per-source Trash**

Full list of features: [Full Feature Wiki](https://github.com/error311/FileRise/wiki/Features)

![FileRise](https://raw.githubusercontent.com/error311/FileRise/master/resources/filerise-v3.0.0.png)

![Sources](https://raw.githubusercontent.com/error311/FileRise/master/resources/FileRisePro-Sources.gif)

> üí° Looking for **FileRise Pro** (brandable header, **user groups**, **client upload portals**, license handling)?
> Check out [filerise.net](https://filerise.net) ‚Äì FileRise Core stays fully open-source (MIT).

---

## Quick links

- üöÄ **Live demo:** [Demo](https://demo.filerise.net) (username: `demo` / password: `demo`)
- üß© **FileRise Pro:** [filerise.net](https://filerise.net)
- üìö **Docs & Wiki:** [Wiki](https://github.com/error311/FileRise/wiki)
  - [Features overview](https://github.com/error311/FileRise/wiki/Features)
  - [Installation & setup](https://github.com/error311/FileRise/wiki/Installation-Setup)
  - [Common env vars](https://github.com/error311/FileRise/wiki/Common-Env-Variables)
  - [Env vars (full reference)](https://github.com/error311/FileRise/wiki/Environment-Variables-Full-Reference)
  - [WebDAV (mount)](https://github.com/error311/FileRise/wiki/WebDAV)
  - [WebDAV via curl](https://github.com/error311/FileRise/wiki/Accessing-FileRise-via-curl%C2%A0(WebDAV))
  - [ONLYOFFICE](https://github.com/error311/FileRise/wiki/ONLYOFFICE)
  - [OIDC & SSO](https://github.com/error311/FileRise/wiki/OIDC-and-SSO)
  - [Nginx setup](https://github.com/error311/FileRise/wiki/Nginx-Setup)
  - [Kubernetes / k8s](https://github.com/error311/FileRise/wiki/Kubernetes---k8s-deployment)
  - [Backup & restore](https://github.com/error311/FileRise/wiki/Backup-and-Restore)
  - [Reverse proxy & subpath](https://github.com/error311/FileRise/wiki/Reverse-Proxy-and-Subpath)
- üê≥ **Docker image:**  
  - Docker Hub: [Docker](https://hub.docker.com/r/error311/filerise-docker)
  - Build pipeline / tags: [Workflow](https://github.com/error311/filerise-docker)
- üí¨ **Discord:** [Discord](https://discord.gg/7WN6f56X2e)
- üìù **Changelog:** [Changelog](https://github.com/error311/FileRise/blob/master/CHANGELOG.md)

### Support checklist (please include)

If you open an issue/discussion, please include:

- FileRise version + install method (Docker tag / release ZIP / git)
- Reverse proxy (Nginx / Traefik / Caddy) + subpath (yes/no)
- Browser console errors (if any)
- Server/container logs around the error

---

## Install (Docker ‚Äì recommended)

The easiest way to run FileRise is the official Docker image.

> ‚úÖ **Tip:** For stability, pin a version tag (example: `error311/filerise-docker:vX.Y.Z`) instead of `:latest`. See [Releases](https://github.com/error311/FileRise/releases) for current versions.

### Option A ‚Äì Quick start (docker run)

```bash
docker run -d \
  --name filerise \
  -p 8080:80 \
  -e TIMEZONE="America/New_York" \
  -e TOTAL_UPLOAD_SIZE="10G" \
  -e SECURE="false" \
  -e PERSISTENT_TOKENS_KEY="default_please_change_this_key" \
  -e SCAN_ON_START="true" \
  -e CHOWN_ON_START="true" \
  -v ~/filerise/uploads:/var/www/uploads \
  -v ~/filerise/users:/var/www/users \
  -v ~/filerise/metadata:/var/www/metadata \
  error311/filerise-docker:latest
```

Then visit:

```text
http://your-server-ip:8080
```

On first launch you‚Äôll be guided through creating the **initial admin user**.

> üí° After the first run, you can set `CHOWN_ON_START="false"` if permissions are already correct and you don‚Äôt want a recursive `chown` on uploads/metadata on every start.
>
> ‚ö†Ô∏è **Uploads folder recommendation**
>
> It‚Äôs strongly recommended to bind `/var/www/uploads` to a **dedicated folder**
> (for example `~/filerise/uploads` or `/mnt/user/appdata/FileRise/uploads`),
> not the root of a huge media share.
>
> If you really want FileRise to sit ‚Äúon top of‚Äù an existing share, use a
> subfolder (e.g. `/mnt/user/media/filerise_root`) instead of the share root,
> so scans and permission changes stay scoped to that folder.

### Option B ‚Äì docker-compose.yml

```yaml
services:
  filerise:
    image: error311/filerise-docker:latest
    container_name: filerise
    ports:
      - "8080:80"
    environment:
      TIMEZONE: "America/New_York"
      TOTAL_UPLOAD_SIZE: "10G"
      SECURE: "false"
      PERSISTENT_TOKENS_KEY: "default_please_change_this_key"
      SCAN_ON_START: "true"   # auto-index existing files on startup
      CHOWN_ON_START: "true"  # fix permissions on uploads/metadata on startup
    volumes:
      - ./uploads:/var/www/uploads
      - ./users:/var/www/users
      - ./metadata:/var/www/metadata
```

Bring it up with:

```bash
docker compose up -d
```

### Common environment variables

| Variable                | Required | Example                          | What it does |
|-------------------------|----------|----------------------------------|--------------|
| `TIMEZONE`              | ‚úÖ       | `America/New_York`               | PHP / container timezone. |
| `TOTAL_UPLOAD_SIZE`     | ‚úÖ       | `10G`                            | Max total upload size per request; also used to set PHP/Apache upload limits. |
| `SECURE`                | ‚úÖ       | `false`                          | `true` when running behind HTTPS / a reverse proxy, else `false`. |
| `PERSISTENT_TOKENS_KEY` | ‚úÖ       | `change_me_super_secret`         | Secret used to encrypt stored secrets (tokens, permissions, admin config). **Do not leave this at the default.** |
| `SCAN_ON_START`         | Optional | `true`                           | If `true`, runs a scan once on container start to index existing files. |
| `CHOWN_ON_START`        | Optional | `true`                           | If `true`, recursively normalizes ownership/permissions on `uploads/` + `metadata/`. |
| `PUID`                  | Optional | `99`                             | If running as root, remap `www-data` user to this UID (e.g. Unraid‚Äôs 99).                             |
| `PGID`                  | Optional | `100`                            | If running as root, remap `www-data` group to this GID (e.g. Unraid‚Äôs 100).                           |
| `FR_PUBLISHED_URL`      | Optional | `https://example.com/files`      | Public URL when behind proxies/subpaths (share links, portals, redirects). |
| `FR_BASE_PATH`          | Optional | `/files`                         | Force a subpath when the proxy strips the prefix (overrides auto-detect). |
| `FR_TRUSTED_PROXIES`    | Optional | `127.0.0.1,10.0.0.0/8`            | Comma-separated IPs/CIDRs for trusted proxies; only these can supply the client IP header. |
| `FR_IP_HEADER`          | Optional | `X-Forwarded-For`                | Header to trust for the real client IP when the proxy is trusted. |

> Full list of common env variables: [Common Environment variables](https://github.com/error311/FileRise/wiki/Common-Env-Variables)
> Full reference: [Environment Variables (Full Reference)](https://github.com/error311/FileRise/wiki/Environment-Variables-Full-Reference)
>
> Other useful env vars (optional):  
> `FR_WEBDAV_MAX_UPLOAD_BYTES` (WebDAV upload cap in bytes; `0` = unlimited),  
> `FR_ENCRYPTION_MASTER_KEY` (32-byte key: hex or `base64:...`),  
> `VIRUS_SCAN_ENABLED` / `VIRUS_SCAN_CMD` / `CLAMAV_AUTO_UPDATE`,  
> `LOG_STREAM` (`error`/`access`/`both`/`none`),  
> `HTTP_PORT` / `HTTPS_PORT` / `SERVER_NAME`,  
> `SHARE_URL` (override share endpoint; `FR_PUBLISHED_URL` preferred).
>
> üß© **Traefik + subpath note (Kubernetes):** use `StripPrefix` and rely on `X-Forwarded-Prefix` + `FR_PUBLISHED_URL`.  
> See: [Deployments Wiki](https://github.com/error311/FileRise/wiki/Kubernetes---k8s-deployment)
> More deployment docs: [Install Setup](https://github.com/error311/FileRise/wiki/Installation-Setup)

---

## Manual install (PHP web server)

> ‚ö†Ô∏è **Manual installs: understand the default paths (saves you 30 minutes of pain)**
>
> By default, FileRise writes data to **these absolute paths**:
>
> - `/var/www/uploads`
> - `/var/www/users`
> - `/var/www/metadata`
>
> Your web server must point to FileRise‚Äôs **public/** folder:
>
> - DocumentRoot ‚Üí `/var/www/filerise/public` (example)
>
> ‚úÖ **Recommended layout (no config changes):**
>
> - Install FileRise code in: `/var/www/filerise`
> - Create data dirs in: `/var/www/uploads`, `/var/www/users`, `/var/www/metadata`
>
> If you install FileRise under `/var/www/html` (or anywhere else), you must either:
>
> - still create the data folders at `/var/www/{uploads,users,metadata}` **(simplest)**, or
> - change the paths in `config/config.php` to match your layout.
>
>If you created `users/metadata/uploads` under `/var/www/html`, FileRise will still try to write to `/var/www/users` unless you change config.

### Requirements

- PHP **8.3+**
- Web server (Apache / Nginx / Caddy + PHP-FPM)
- PHP extensions: `json`, `curl`, `zip` (and usual defaults)
- No database required

### Step 0: Create data directories (default locations)

```bash
sudo mkdir -p /var/www/uploads /var/www/users /var/www/metadata
sudo chown -R www-data:www-data /var/www/uploads /var/www/users /var/www/metadata   # adjust web user if needed
sudo chmod -R 775 /var/www/uploads /var/www/users /var/www/metadata
```

Quick write test:

```bash
sudo -u www-data touch /var/www/users/.write_test && echo OK
```

### Login security notes

- Failed login attempts are throttled per **IP + username** and stored in `/var/www/users/failed_logins.json` by default.
- Failed logins are also written to `/var/www/users/fail2ban.log` (rotate at 50MB, keep 5 files).
- If you‚Äôre behind a reverse proxy, set `FR_TRUSTED_PROXIES` and `FR_IP_HEADER` so rate limiting and logs use the real client IP.

### Install from release ZIP (recommended)

Get the latest tag from [Releases](https://github.com/error311/FileRise/releases).

```bash
cd /var/www
sudo mkdir -p filerise
sudo chown -R $USER:$USER /var/www/filerise
cd /var/www/filerise

VERSION="vX.Y.Z"  # replace with the tag you want
ASSET="FileRise-${VERSION}.zip"

curl -fsSL "https://github.com/error311/FileRise/releases/download/${VERSION}/${ASSET}" -o "${ASSET}"
unzip "${ASSET}"
```

Point your web server at `public/`:

- Apache: `DocumentRoot /var/www/filerise/public`
- Nginx: `root /var/www/filerise/public;`

> ‚úÖ After setting DocumentRoot to `.../public`, access FileRise at:
> `http://serverip/` (not `http://serverip/public/`)

### Install from git (developer mode)

```bash
cd /var/www
sudo git clone https://github.com/error311/FileRise.git filerise
sudo chown -R $USER:$USER /var/www/filerise

cd /var/www/filerise
composer install
```

### Manual install troubleshooting (common mistakes)

- **Browsing `/public` in the URL**
  - Wrong: `http://serverip/public/`
  - Correct: `http://serverip/`
- **‚ÄúFailed to write users file‚Äù**
  - Check your server error log ‚Äî it will show the exact write path.
  - If it mentions `/var/www/users/users.txt`, fix permissions on `/var/www/users` (not `/var/www/html/users`).
- **open_basedir restrictions**
  - Ensure it includes `/var/www` and `/tmp` (example: `/var/www:/tmp`).

---

## Data & backups

Back up these paths (Docker volumes or host directories):

- `/var/www/uploads` (file data)
- `/var/www/users` (users, ACLs, admin config, Pro license)
- `/var/www/metadata` (indexes, tags, logs)

Notes:
- Logs live in `/var/www/metadata/log` and can be rotated or pruned.
- Keep your `PERSISTENT_TOKENS_KEY` consistent when restoring backups.

## First-run security checklist

- Set a strong `PERSISTENT_TOKENS_KEY` (encrypts tokens, permissions, admin config).
- Use HTTPS and set `SECURE="true"` when behind TLS/reverse proxy.
- If behind a proxy, set `FR_TRUSTED_PROXIES` and `FR_IP_HEADER`.
- Set `FR_PUBLISHED_URL` (and `FR_BASE_PATH` if needed) so share links are correct.

## Optional dependencies

- **FFmpeg** ‚Äì video thumbnails (set `FR_FFMPEG_PATH` if not on PATH).
- **ClamAV** ‚Äì upload scanning (`VIRUS_SCAN_ENABLED=true`).
- **PHP sodium (libsodium)** ‚Äì required for encryption-at-rest.
- **ONLYOFFICE Document Server** ‚Äì document editing in the browser.

---

## WebDAV & ONLYOFFICE (optional)

### WebDAV

Once enabled in the Admin panel, FileRise exposes a WebDAV endpoint (e.g. `/webdav.php`). Use it with:

- **macOS Finder** ‚Äì Go ‚Üí Connect to Server ‚Üí `https://your-host/webdav.php/`
- **Windows File Explorer** ‚Äì Map Network Drive ‚Üí `https://your-host/webdav.php/`
- **Linux (GVFS/Nautilus)** ‚Äì `dav://your-host/webdav.php/`
- Clients like **Cyberduck**, **WinSCP**, etc.

WebDAV operations honor the same ACLs as the web UI.

Docs: [WebDAV Wiki](https://github.com/error311/FileRise/wiki/WebDAV)

### ONLYOFFICE integration

If you run an ONLYOFFICE Document Server you can open/edit Office documents directly from FileRise (DOCX, XLSX, PPTX, ODT, ODS, ODP; PDFs view-only).

Configure it in **Admin ‚Üí ONLYOFFICE**:

- Enable ONLYOFFICE
- Set your Document Server origin (e.g. `https://docs.example.com`)
- Configure a shared JWT secret
- Copy the suggested Content-Security-Policy header into your reverse proxy

Docs: [ONLYOFFICE Wiki](https://github.com/error311/FileRise/wiki/ONLYOFFICE)

---

## Security & updates

- FileRise is actively maintained and has published security advisories.
- See **SECURITY.md** and GitHub Security Advisories for details.

### Upgrading

- **Docker:** pull the new tag and recreate the container with the same volumes.

Example:  

  ```bash
  docker pull error311/filerise-docker:latest
  # or pin a specific version from Releases
  ```

- **Manual:** replace app files with the latest release ZIP (keep `/var/www/uploads`, `/var/www/users`, `/var/www/metadata`, and your config).

Please report vulnerabilities responsibly via the channels listed in **SECURITY.md**.

---

## Community, support & contributing

Contributions are welcome ‚Äî from bug fixes and docs to translations and UI polish.  
See `CONTRIBUTING.md` for guidelines.

If FileRise saves you time or becomes your daily driver, a ‚≠ê on GitHub or sponsorship is hugely appreciated:

- ‚ù§Ô∏è [GitHub Sponsors](https://github.com/sponsors/error311)
- ‚òï [Ko-Fi](https://ko-fi.com/error311)

---

## AI Disclosure

FileRise is my project. I use AI like a tool for some tasks (e.g., translations/snippets), but the architecture, core code, and ongoing maintenance are mine.

---

## License & third-party code

FileRise Core is released under the **MIT License** ‚Äì see `LICENSE`.

It bundles a small set of well-known client and server libraries (Bootstrap, CodeMirror, DOMPurify, Fuse.js, Resumable.js, sabre/dav, etc.).  
All third-party code remains under its original licenses.

The official Docker image includes the **ClamAV** antivirus scanner (GPL-2.0-only) for optional upload scanning.

See `THIRD_PARTY.md` and the `licenses/` folder for full details.

---

## Press

- [Heise / iX Magazin ‚Äì ‚ÄúFileRise 2.0: Web-Dateimanager mit Client Portals‚Äù (DE)](https://www.heise.de/news/FileRise-2-0-Web-Dateimanager-mit-Client-Portals-11092171.html)
- [Heise / iX Magazin ‚Äì ‚ÄúFileRise 2.0: Web File Manager with Client Portals‚Äù (EN)](https://www.heise.de/en/news/FileRise-2-0-Web-File-Manager-with-Client-Portals-11092376.html)
